(function(){window.boneVojage=function(b,a){var c=this;window.boneVojage_main={settings:{$body:$("body"),$window:$(window),$document:$(document),$body_html:$("body,html"),currPoint:0,tryPositionCount:0,points:[],$modalTop:0,$modalBottom:0,$modalLeft:0,$modalRight:0,$tooltip:0},options:{delay:1000,offset:4,positionPriority:["bottom","top","left","right","bottom_left","bottom_right","top_left","top_right"],position:"best",button_next:39,button_prev:37,map:true,buttons:true},constructor:function(e,d){var f,g=this;
if(boneVojage_main.options.buttons){f='<div id="buttons"><div id="prev">prev</div><div id="next">next</div></div>';}else{f="";}boneVojage_main.settings.$body.append('<div id="modal_top"></div><div id="modal_bottom"></div><div id="modal_left"></div><div id="modal_right"></div><div id="tooltip"><div id="close"></div><div id="text"></div>'+f+"<ul></ul></div>");
boneVojage_main.settings.$modalTop=$("div#modal_top");boneVojage_main.settings.$modalBottom=$("div#modal_bottom");boneVojage_main.settings.$modalLeft=$("div#modal_left");
boneVojage_main.settings.$modalRight=$("div#modal_right");boneVojage_main.settings.$tooltip=$("div#tooltip");boneVojage_main.settings.points=e;boneVojage_main.settings.scrollBeforeVojageY=boneVojage_main.settings.$window.scrollTop();
boneVojage_main.settings.scrollBeforeVojageX=boneVojage_main.settings.$window.scrollLeft();if(boneVojage_main.options.map){boneVojage_main.O.makeMap();
}boneVojage_main.O.makeModalPosition(e[boneVojage_main.settings.currPoint].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal();
});return boneVojage_main.E.listen();},E:{listen:function(){boneVojage_main.settings.$document.on("keyup",function(d){switch(d.keyCode){case parseInt(boneVojage_main.options.button_next,10):if(boneVojage_main.settings.currPoint<boneVojage_main.settings.points.length-1){return boneVojage_main.O.next();
}break;case parseInt(boneVojage_main.options.button_prev,10):if(boneVojage_main.settings.currPoint>0){return boneVojage_main.O.prev();}}});return boneVojage_main.settings.$tooltip.on("click","#next",function(){return boneVojage_main.O.next();
}).on("click","#prev",function(){return boneVojage_main.O.prev();}).on("click","#close",function(){boneVojage_main.settings.tryPositionCount=0;boneVojage_main.O.hideModal();
return boneVojage_main.settings.$body_html.animate({scrollTop:boneVojage_main.settings.scrollBeforeVojageY,scrollLeft:boneVojage_main.settings.scrollBeforeVojageX},boneVojage_main.options.delay);
}).on("click","li",boneVojage_main.O.makeVojageProgress);}},O:{makeMap:function(){var d,f,e;f="";for(d=0,e=b.length-1;0<=e?d<=e:d>=e;0<=e?d++:d--){f+="<li></li>";
}return boneVojage_main.settings.$tooltip.find("ul").html(f);},makeVojageProgress:function(){var d=this;boneVojage_main.settings.tryPositionCount=0;boneVojage_main.settings.currPoint=$(this).index();
return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[boneVojage_main.settings.currPoint].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal();
});},next:function(){var d=this;boneVojage_main.settings.tryPositionCount=0;return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[++boneVojage_main.settings.currPoint].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal();
});},prev:function(){var d=this;boneVojage_main.settings.tryPositionCount=0;return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[--boneVojage_main.settings.currPoint].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal();
});},getGSides:function(f){var e,d;d=boneVojage_main.settings.$tooltip.outerWidth()>f.outerWidth()?f.offset().left+f.outerWidth()+(Math.abs(f.outerWidth()-boneVojage_main.settings.$tooltip.outerWidth())/2):f.offset().left+f.outerWidth();
e=boneVojage_main.settings.$tooltip.outerWidth()>f.outerWidth()?f.offset().left-(Math.abs(f.outerWidth()-boneVojage_main.settings.$tooltip.outerWidth())/2):f.offset().left;
return{g_right:d,g_left:e};},makeTooltipPosition:function(h,f,g){var e,d;d=boneVojage_main.O.getPosition(f);boneVojage_main.settings.$tooltip.css({position:d.fixed});
if(h!=="best"){boneVojage_main.settings.$tooltip.attr("class","");boneVojage_main.settings.$tooltip.addClass(h);}switch(h){case"left":boneVojage_main.settings.$tooltip.css({top:f.offset().top-(boneVojage_main.settings.$tooltip.outerHeight()/2)+(f.outerHeight()/2)-d.normH,left:f.offset().left-(boneVojage_main.settings.$tooltip.outerWidth())-g-d.normY});
break;case"right":boneVojage_main.settings.$tooltip.css({top:f.offset().top-(boneVojage_main.settings.$tooltip.outerHeight()/2)+(f.outerHeight()/2)-d.normH,left:f.offset().left+f.outerWidth()+g-d.normY});
break;case"top":boneVojage_main.settings.$tooltip.css({top:f.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-g-7-d.normH,left:f.offset().left+(f.outerWidth()/2)-(boneVojage_main.settings.$tooltip.outerWidth()/2)-d.normY});
break;case"top_left":boneVojage_main.settings.$tooltip.css({top:f.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-7-d.normH,left:f.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-d.normY});
break;case"top_right":boneVojage_main.settings.$tooltip.css({top:f.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-7-d.normH,left:f.offset().left+f.outerWidth()-d.normY});
break;case"bottom":boneVojage_main.settings.$tooltip.css({top:f.offset().top+f.outerHeight()+g-d.normH,left:f.offset().left+(f.outerWidth()/2)-(boneVojage_main.settings.$tooltip.outerWidth()/2)-d.normY});
break;case"bottom_right":boneVojage_main.settings.$tooltip.css({top:f.offset().top+f.outerHeight()-d.normH,left:f.outerWidth()+f.offset().left-d.normY});
break;case"bottom_left":boneVojage_main.settings.$tooltip.css({top:f.offset().top+f.outerHeight()-d.normH,left:f.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-d.normY});
break;case"best":e=boneVojage_main.settings.tryPositionCount++;if(e<boneVojage_main.options.positionPriority.length){boneVojage_main.O.makeTooltipPosition(boneVojage_main.O.tryPosition[boneVojage_main.options.positionPriority[e]](f,boneVojage_main.options.offset),f,boneVojage_main.options.offset);
}else{boneVojage_main.O.makeTooltipPosition(boneVojage_main.options.positionPriority[0],f,boneVojage_main.options.offset);}}return f;},tryPosition:{left:function(d,e){if((d.offset().left-boneVojage_main.settings.$tooltip.outerWidth())-e>boneVojage_main.settings.$window.scrollLeft()&&((d.offset().top-(Math.abs(d.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2))>boneVojage_main.settings.$window.scrollTop())&&(d.offset().top+(Math.abs(d.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2)<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight())){return"left";
}else{return"best";}},right:function(d,e){if(d.offset().left+d.outerWidth()+e<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth()&&((d.offset().top-(Math.abs(d.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2))>boneVojage_main.settings.$window.scrollTop())&&(d.offset().top+(Math.abs(d.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2)<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight())){return"right";
}else{return"best";}},top:function(d,f){var e;e=boneVojage_main.O.getGSides(d);if(d.offset().top-f-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&(e.g_left>boneVojage_main.settings.$window.scrollLeft())&&(e.g_right<boneVojage_main.settings.$window.outerWidth()+boneVojage_main.settings.$window.scrollLeft())){return"top";
}else{return"best";}},top_left:function(d,e){if(d.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-e-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&((d.offset().left-boneVojage_main.settings.$tooltip.outerWidth())>boneVojage_main.settings.$window.scrollLeft())){return"top_left";
}else{return"best";}},top_right:function(d,e){if(d.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-e-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&((d.offset().left+d.outerWidth()+boneVojage_main.settings.$tooltip.outerWidth())<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth())){return"top_right";
}else{return"best";}},bottom:function(d,f){var e;e=boneVojage_main.O.getGSides(d);if((d.offset().top+d.outerHeight()+f+boneVojage_main.settings.$tooltip.outerHeight())<(boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight())&&(e.g_left>boneVojage_main.settings.$window.scrollLeft())&&(e.g_right<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth())){return"bottom";
}else{return"best";}},bottom_left:function(d,e){if((d.offset().top+d.outerHeight()+e+boneVojage_main.settings.$tooltip.outerHeight())<(boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight())&&(d.offset().left-boneVojage_main.settings.$tooltip.outerWidth()>boneVojage_main.settings.$window.scrollLeft())){return"bottom_left";
}else{return"best";}},bottom_right:function(d,e){if((d.offset().top+d.outerHeight()+e+boneVojage_main.settings.$tooltip.outerHeight())<(boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight())&&(d.offset().left+d.outerWidth()+boneVojage_main.settings.$tooltip.outerWidth()<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth())){return"bottom_right";
}else{return"best";}}},showModal:function(){boneVojage_main.settings.$modalTop.fadeIn();boneVojage_main.settings.$modalBottom.fadeIn();boneVojage_main.settings.$modalLeft.fadeIn();
boneVojage_main.settings.$modalRight.fadeIn();return boneVojage_main.settings.$tooltip.fadeIn();},addControls:function(){if(boneVojage_main.settings.currPoint<boneVojage_main.settings.points.length-1){boneVojage_main.settings.$tooltip.find("#next").show();
}if(boneVojage_main.settings.currPoint>0){return boneVojage_main.settings.$tooltip.find("#prev").show();}},hideModal:function(){boneVojage_main.settings.$tooltip.find("#next,#prev").hide();
boneVojage_main.settings.$tooltip.hide();boneVojage_main.settings.$modalTop.hide();boneVojage_main.settings.$modalBottom.hide();boneVojage_main.settings.$modalLeft.hide();
return boneVojage_main.settings.$modalRight.hide();},getPosition:function(e){var g,f,h,d,i;g=e.css("position");h=e.offset().top-(boneVojage_main.settings.$window.outerHeight()/2);
d=e.offset().left-(boneVojage_main.settings.$window.outerWidth()/2);f=0;i=0;if(g!=="fixed"){g="absolute";}else{h=boneVojage_main.settings.$window.scrollTop();
d=boneVojage_main.settings.$window.scrollLeft();f=boneVojage_main.settings.$window.scrollTop();i=boneVojage_main.settings.$window.scrollLeft();}return{fixed:g,normH:f,normY:i,normScrollH:h,normScrollY:d};
},makeModalPosition:function(g){var f,e,h,d,i;f=$(g);d=boneVojage_main.O.getPosition(f);boneVojage_main.O.hideModal();h=$.Deferred();e=0;i=boneVojage_main.options.offset;
boneVojage_main.settings.$tooltip.find("li").eq(boneVojage_main.settings.currPoint).addClass("active").siblings().removeClass("active");boneVojage_main.settings.$body_html.stop(true,false).animate({scrollTop:d.normScrollH,scrollLeft:d.normScrollY},boneVojage_main.options.delay,function(){if(e++===0){h.resolve();
boneVojage_main.settings.$modalTop.css({position:d.fixed,height:(f.offset().top-i)-d.normH,width:f.outerWidth()+(i*2),left:f.offset().left-i-d.normY});
boneVojage_main.settings.$modalBottom.css({position:d.fixed,height:$(document).outerHeight()-f.offset().top-f.outerHeight()-i+d.normY,width:f.outerWidth()+(i*2),left:f.offset().left-i-d.normY,top:f.offset().top+f.outerHeight()+i-d.normH});
boneVojage_main.settings.$modalLeft.css({position:d.fixed,width:boneVojage_main.settings.$body.outerWidth()-(boneVojage_main.settings.$body.outerWidth()-f.offset().left)-i-d.normY,height:$(document).outerHeight()-d.normH});
boneVojage_main.settings.$modalRight.css({position:d.fixed,left:(f.offset().left+f.outerWidth()+i)-d.normY,height:$(document).outerHeight()-d.normH,width:boneVojage_main.settings.$body.outerWidth()-(f.offset().left+f.outerWidth())-i});
boneVojage_main.settings.$tooltip.find("#text").text(boneVojage_main.settings.points[boneVojage_main.settings.currPoint].text);boneVojage_main.O.addControls();
return boneVojage_main.O.makeTooltipPosition(boneVojage_main.options.position,f,i);}});return h.promise();}}};boneVojage_main.options=$.extend({},boneVojage_main.options,a||{});
return boneVojage_main.constructor(b);};}).call(this);